/* Copyright (c) 2024 Soft The Next, All Rights Reserved. */

const crypto=require("crypto"),digits="0123456789",lowerCaseAlphabets="abcdefghijklmnopqrstuvwxyz",upperCaseAlphabets=lowerCaseAlphabets.toUpperCase(),specialChars="#!&@";module.exports={generate:function(e,s){e=e||10;const t=s||{};t.digits=!Object.prototype.hasOwnProperty.call(t,"digits")||s.digits,t.lowerCaseAlphabets=!Object.prototype.hasOwnProperty.call(t,"lowerCaseAlphabets")||s.lowerCaseAlphabets,t.upperCaseAlphabets=!Object.prototype.hasOwnProperty.call(t,"upperCaseAlphabets")||s.upperCaseAlphabets,t.specialChars=!Object.prototype.hasOwnProperty.call(t,"specialChars")||s.specialChars;const p=(t.digits?digits:"")+(t.lowerCaseAlphabets?lowerCaseAlphabets:"")+(t.upperCaseAlphabets?upperCaseAlphabets:"")+(t.specialChars?"#!&@":"");let a="";for(;a.length<e;){const e=crypto.randomInt(0,p.length);0===a.length&&!0===t.digits&&"0"===p[e]||(a+=p[e])}return a}};